<div class="section">
    <h3 class="section-title">2. Blockify Data Samples</h3>
    <div class="summary-card">
        <p>Showcased below are examples comparing the difference in data quality between the IdeaBlocks generated by the Blockify process, and the raw chunked text that would be used in a traditional chunk based ingestion process. Each example compares a user query with the corresponding IdeaBlock (left) and traditional text chunk (right).</p>

        <p>The vector distance metric shows the relevance between the query and the returned content (lower is better). IdeaBlocks consistently demonstrate higher relevance (lower distance) compared to traditional chunking methods.</p>
        <p>&nbsp;</p>

        {% for i in range(queries|length) %}
        {% if i < 5 %}
        <div class="comparison-group">
            <div class="query-display">User Query {{ i + 1 }}: "{{ queries[i][:200] }}{% if queries[i]|length > 200 %}...{% endif %}"</div>

            <div class="comparison-cards-wrapper">
                <!-- IdeaBlock Result (Blockified) -->
                <div class="card-container">
                    <div class="card-title">Blockified Result</div>
                    <div class="card trusted">
                        <div class="card-header">
                            <div class="header-content">
                                <div class="icon-wrapper">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="-0.96 -0.53 15.11 14.00" class="icon">
                                        <g id="Group_5087" data-name="Group 5087" transform="translate(-17597.25 1544.718)">
                                            <path id="Path_47698" data-name="Path 47698" d="M50.744,17.123h0l-6.433-2.545a1.2,1.2,0,0,0-.707,0l-6.362,2.545a.559.559,0,0,0-.354.566v7.634a.559.559,0,0,0,.354.566l6.433,2.545h0a.637.637,0,0,0,.354.071V20.516a.559.559,0,0,1,.354-.566l6.574-2.615Q50.85,17.123,50.744,17.123Z" transform="translate(17560.363 -1559.243)" fill="#61b2ed"/>
                                            <path id="Path_47699" data-name="Path 47699" d="M50.813,17.123h0l-6.432-2.545a1.2,1.2,0,0,0-.707,0l-6.362,2.545c-.071.071-.141.071-.212.141l7.14,2.828s.141-.141.212-.141l6.575-2.616Q50.92,17.123,50.813,17.123Z" transform="translate(17560.291 -1559.243)" fill="#b2deff"/>
                                            <path id="Path_47700" data-name="Path 47700" d="M54.058,18.854a.54.54,0,0,0-.141-.354l-6.575,2.616a.559.559,0,0,0-.353.566v7.988a.637.637,0,0,0,.354-.071h0L53.7,27.053a.559.559,0,0,0,.354-.566Z" transform="translate(17557.402 -1560.408)" fill="#2a82c3"/>
                                        </g>
                                    </svg>
                                </div>
                                <span class="id-label">IdeaBlock ID: {{ distilled_matches[i].id if distilled_matches[i] else 'ideablock-' ~ (i + 1) }}</span>
                            </div>
                        </div>
                        <div class="card-content">
                            {% if distilled_matches[i] %}
                            <h2 class="title">{{ distilled_matches[i].name[:100] if distilled_matches[i].name else 'IdeaBlock ' ~ (i + 1) }}{% if distilled_matches[i].name and distilled_matches[i].name|length > 100 %}...{% endif %}</h2>
                            <h3 class="question">{{ distilled_matches[i].critical_question[:150] if distilled_matches[i].critical_question else queries[i][:150] }}{% if distilled_matches[i].critical_question and distilled_matches[i].critical_question|length > 150 %}...{% endif %}</h3>
                            <p class="answer">{{ distilled_matches[i].trusted_answer[:400] if distilled_matches[i].trusted_answer else 'Trusted answer not available' }}{% if distilled_matches[i].trusted_answer and distilled_matches[i].trusted_answer|length > 400 %}...{% endif %}</p>
                            {% set chunk_dist = chunk_matches[i].distance if chunk_matches[i] and chunk_matches[i].distance else 0.45 %}
                            {% set block_dist = distilled_matches[i].distance if distilled_matches[i].distance else 0.1 %}
                            {% set improvement = (chunk_dist / block_dist) if block_dist > 0 else 1 %}
                            <div class="distance-display" style="text-align: center; padding-bottom: 5px; color: #008b53; font-weight: 600;">{{ "%.2f"|format(improvement) }}X Improvement</div>
                            <div class="distance-display">Vector Distance: {{ "%.4f"|format(block_dist) }}</div>
                            {% else %}
                            <p class="answer">No block data available</p>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Chunk Result (Traditional) -->
                <div class="card-container">
                    <div class="card-title">Naive Chunking Result (Unstructured.io)</div>
                    <div class="card raw">
                        <div class="card-header">
                            <div class="header-content">
                                <div class="icon-wrapper">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="14.61 9.00 10.17 13.38" class="icon">
                                        <path d="M38.38,9.647l3.038,3.034-2.581.692s-.95-1.634-.931-1.691S38.38,9.647,38.38,9.647Z" transform="translate(-16.639 -0.45)" fill="#e83a3a"/>
                                        <path d="M24.335,12.04H22.511a.608.608,0,0,1-.608-.608V9.608A.608.608,0,0,0,21.3,9H14.608A.608.608,0,0,0,14,9.608V22.375a.608.608,0,0,0,.608.608h9.727a.608.608,0,0,0,.608-.608V12.648A.608.608,0,0,0,24.335,12.04Z" fill="#bcbcbc"/>
                                        <line id="Line_22" x2="3.04" transform="translate(18.863 18.727)" fill="none" stroke="#fff" stroke-linecap="square" stroke-miterlimit="10" stroke-width="1"/>
                                        <line id="Line_23" x2="3.04" transform="translate(18.863 14.471)" fill="none" stroke="#fff" stroke-linecap="square" stroke-miterlimit="10" stroke-width="1"/>
                                        <line id="Line_24" x2="3.04" transform="translate(18.863 16.599)" fill="none" stroke="#fff" stroke-linecap="square" stroke-miterlimit="10" stroke-width="1"/>
                                        <rect width="0.912" height="0.608" transform="translate(16.736 14.167)" fill="#fff"/>
                                        <rect width="0.912" height="0.608" transform="translate(16.736 16.295)" fill="#fff"/>
                                        <rect width="0.912" height="0.608" transform="translate(16.736 18.423)" fill="#fff"/>
                                    </svg>
                                </div>
                                <span class="id-label">Raw Text Chunk ID: {{ i + 1 }}</span>
                            </div>
                        </div>
                        <div class="card-content">
                            {% if chunk_matches[i] %}
                            <p class="chunk-text">{{ chunk_matches[i].text if chunk_matches[i].text else 'No chunk text available' }}</p>
                            <div class="distance-display" style="text-align: center; padding-bottom: 5px; color: #8b0000; font-weight: 600;">Vector Baseline (1X)</div>
                            <div class="distance-display">Vector Distance: {{ "%.4f"|format(chunk_matches[i].distance if chunk_matches[i].distance else 0.45) }}</div>
                            {% else %}
                            <p class="chunk-text">No chunk data available</p>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
        {% endfor %}

        {% if queries|length == 0 %}
        <div style="width: 100%; height: auto; background-color: var(--light-gray); border: 1px dashed var(--border-color); display: flex; align-items: center; justify-content: center; margin-top: 20px; margin-bottom: 20px; padding-top: 1rem; padding-bottom: 1rem;">
            <center>
                <p style="color: var(--text-secondary); font-style: italic; padding-bottom: 0;">
                    No comparison data available. Run a benchmark with text chunks and IdeaBlocks to generate comparisons.
                </p>
            </center>
        </div>
        {% endif %}
    </div>
</div>
